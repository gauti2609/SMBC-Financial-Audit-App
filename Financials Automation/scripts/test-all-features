#!/bin/bash

# Comprehensive Feature Testing Script
# Tests all major application features to ensure everything works after fixes

set -e

echo "ğŸ§ª Starting Comprehensive Feature Testing..."
echo "This will test all major application features systematically."
echo ""

# Change to the project directory
cd "$(dirname "$0")/.."

# Check if the server is running
echo "ğŸ” Checking if server is running..."
if ! pgrep -f "vinxi" > /dev/null; then
    echo "âŒ Server is not running. Please start the server first with:"
    echo "   ./scripts/run"
    exit 1
fi

echo "âœ… Server is running"
echo ""

# Run the comprehensive test suite
echo "ğŸš€ Executing comprehensive feature tests..."
echo ""

# Use tsx to run the TypeScript test file directly
npx tsx src/server/scripts/testAllFeatures.ts

echo ""
echo "âœ¨ Feature testing completed!"
echo ""
echo "ğŸ“ Next steps:"
echo "   â€¢ Review any failed tests above"
echo "   â€¢ Check server logs if needed: docker logs financial-app"
echo "   â€¢ Test the web interface manually for UI functionality"
echo "   â€¢ Run specific feature tests if issues are found"
