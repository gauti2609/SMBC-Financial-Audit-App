#!/bin/bash

# Comprehensive Feature Testing Script
# Tests all major application features to ensure everything works after fixes

set -e

echo "🧪 Starting Comprehensive Feature Testing..."
echo "This will test all major application features systematically."
echo ""

# Change to the project directory
cd "$(dirname "$0")/.."

# Check if the server is running
echo "🔍 Checking if server is running..."
if ! pgrep -f "vinxi" > /dev/null; then
    echo "❌ Server is not running. Please start the server first with:"
    echo "   ./scripts/run"
    exit 1
fi

echo "✅ Server is running"
echo ""

# Run the comprehensive test suite
echo "🚀 Executing comprehensive feature tests..."
echo ""

# Use tsx to run the TypeScript test file directly
npx tsx src/server/scripts/testAllFeatures.ts

echo ""
echo "✨ Feature testing completed!"
echo ""
echo "📝 Next steps:"
echo "   • Review any failed tests above"
echo "   • Check server logs if needed: docker logs financial-app"
echo "   • Test the web interface manually for UI functionality"
echo "   • Run specific feature tests if issues are found"
