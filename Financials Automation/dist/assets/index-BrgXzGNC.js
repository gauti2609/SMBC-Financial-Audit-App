import{u as C,b as R,r as h,z as o,o as E,j as e,s as y}from"./index-HyfZDTXf.js";import{u as T,L as I,a as u,v as j,p as k,i as D}from"./Layout-tNQcTW0Y.js";import{u as v,a as F,b as L}from"./zod-DIWepabP.js";import{F as N}from"./PencilIcon-DKVLbX6N.js";const q=E({title:y().min(1,"Title is required"),content:y().min(1,"Content is required")});function G(){const m=C(),{selectedCompanyId:a}=R(),[i,l]=h.useState(null),[n,w]=h.useState(""),s=T(a?m.getAccountingPolicies.queryOptions({companyId:a}):{enabled:!1}),d=v({...m.updateAccountingPolicy.mutationOptions(),onSuccess:()=>{o.success("Policy updated successfully!"),s.refetch(),l(null)},onError:t=>{o.error("Failed to update policy: "+t.message)}}),r=v({...m.initializeAccountingPolicies.mutationOptions(),onSuccess:t=>{o.success(`Successfully initialized ${t.count} default accounting policies!`),s.refetch()},onError:t=>{o.error("Failed to initialize policies: "+t.message)}}),{register:g,handleSubmit:P,reset:f,formState:{errors:c}}=F({resolver:L(q)});h.useEffect(()=>{i&&f({title:i.title,content:i.content})},[i,f]);const z=async t=>{!i||!a||await d.mutateAsync({companyId:a,id:i.id,...t})},p=s.data?.filter(t=>t.title.toLowerCase().includes(n.toLowerCase())||t.noteRef.toLowerCase().includes(n.toLowerCase())||t.content.toLowerCase().includes(n.toLowerCase()))||[],S=()=>[{noteRef:"A.2.1",title:"Revenue Recognition (AS 9)",content:`Revenue is recognized when it is probable that the economic benefits will flow to the Company and the revenue can be reliably measured. Revenue from sale of goods is recognized when the significant risks and rewards of ownership of the goods have passed to the buyer, usually on dispatch of the goods.

Service revenue is recognized on proportionate completion basis as the services are performed. Interest income is recognized on a time proportion basis taking into account the amount outstanding and the applicable interest rate.

Dividend income is recognized when the right to receive dividend is established.`},{noteRef:"A.2.2",title:"Property, Plant and Equipment (AS 10)",content:`Property, Plant and Equipment are stated at cost, net of accumulated depreciation and accumulated impairment losses, if any. The cost comprises purchase price, borrowing costs if capitalization criteria are met and directly attributable cost of bringing the asset to its working condition for the intended use.

Subsequent expenditure related to an item of fixed asset is added to its book value only if it increases the future benefits from the existing asset beyond its previously assessed standard of performance. All other expenses on existing fixed assets, including day-to-day repair and maintenance expenditure and cost of replacing parts, are charged to the statement of profit and loss for the period during which such expenses are incurred.

Gains and losses on disposal of fixed assets are determined by comparing proceeds with carrying amount. These are included in profit or loss within other gains/(losses).`},{noteRef:"A.2.3",title:"Intangible Assets (AS 26)",content:`Intangible assets acquired separately are measured on initial recognition at cost. Following initial recognition, intangible assets are carried at cost less accumulated amortization and accumulated impairment losses, if any.

The useful lives of intangible assets are assessed as either finite or indefinite. Intangible assets with finite lives are amortized over the useful economic life and assessed for impairment whenever there is an indication that the intangible asset may be impaired.

Computer software is amortized over a period of 3-5 years on straight line basis.`},{noteRef:"A.2.5",title:"Inventories (AS 2)",content:`Inventories are valued at the lower of cost and net realizable value. Cost of inventories comprises all costs of purchase, costs of conversion and other costs incurred in bringing the inventories to their present location and condition.

Raw materials and stores & spares are valued at cost on weighted average basis. Work-in-progress and finished goods are valued at cost including direct materials, direct labor and a proportion of manufacturing overheads or net realizable value, whichever is lower.

Net realizable value is the estimated selling price in the ordinary course of business, less estimated costs of completion and estimated costs necessary to make the sale.`},{noteRef:"A.2.8",title:"Employee Benefits (AS 15)",content:`Employee benefits include provident fund, employee state insurance scheme, gratuity and compensated absences.

Defined Contribution Plans: The Company's contribution to provident fund and employee state insurance scheme are considered as defined contribution plans and are charged as an expense based on the amount of contribution required to be made.

Defined Benefit Plans: For defined benefit plans such as gratuity, the cost of providing benefits is determined using the projected unit credit method, with actuarial valuations being carried out at each balance sheet date. Actuarial gains and losses are recognized in the statement of profit and loss in the period in which they occur.

Short-term employee benefits: The undiscounted amount of short-term employee benefits expected to be paid in exchange for the services rendered by employees are recognized during the year when the employees render the service.`},{noteRef:"A.2.11",title:"Income Taxes (AS 22)",content:`Tax expense comprises current and deferred tax. Current income tax is measured at the amount expected to be paid to the tax authorities in accordance with the Income Tax Act, 1961.

Deferred income taxes reflect the impact of timing differences between taxable income and accounting income originating during the current year and reversal of timing differences for the earlier years. Deferred tax is measured using the tax rates and the tax laws enacted or substantively enacted at the balance sheet date.

Deferred tax liabilities are recognized for all timing differences. Deferred tax assets are recognized for deductible timing differences only to the extent that there is reasonable certainty that sufficient future taxable income will be available against which such deferred tax assets can be realized.`}],b=async()=>{if(!a){o.error("Please select a company first");return}try{await r.mutateAsync({companyId:a})}catch{}};return e.jsx(I,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Accounting Policies Editor"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Edit and customize standard accounting policy content"})]})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:b,disabled:r.isPending,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(j,{className:`h-5 w-5 ${r.isPending?"animate-spin":""}`}),e.jsx("span",{children:r.isPending?"Initializing...":"Reset to Defaults"})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Search Policies"}),e.jsx("input",{type:"text",placeholder:"Search by title, note ref, or content...",value:n,onChange:t=>w(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.data?.length||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Policies"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(k,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.data?.filter(t=>t.isDefault).length||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Default Policies"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(N,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.data?.filter(t=>!t.isDefault).length||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Modified Policies"})]})]})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Accounting Policies"})}),p.length>0?e.jsx("div",{className:"divide-y divide-gray-200",children:p.map(t=>e.jsx("div",{className:"p-6 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-indigo-100 text-indigo-800",children:t.noteRef}),e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:t.title}),!t.isDefault&&e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800",children:"Modified"})]}),e.jsx("div",{className:"text-sm text-gray-600 max-w-4xl",children:e.jsx("div",{className:"line-clamp-4",children:t.content.split(`
`).map((x,A)=>e.jsx("p",{className:"mb-2",children:x},A))})})]}),e.jsx("div",{className:"ml-4",children:e.jsxs("button",{onClick:()=>l(t),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"Edit"]})})]})},t.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(u,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No policies found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:n?"No policies match your search criteria.":"No accounting policies are available."}),!n&&e.jsx("button",{onClick:b,disabled:r.isPending,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50",children:r.isPending?"Initializing...":"Initialize Default Policies"})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Accounting Policy"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Note Reference: ",i.noteRef]})]}),e.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(D,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:P(z),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Policy Title *"}),e.jsx("input",{...g("title"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter policy title"}),c.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Policy Content *"}),e.jsx("textarea",{...g("content"),rows:15,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono text-sm",placeholder:"Enter detailed policy content..."}),c.content&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.content.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use line breaks to separate paragraphs. Content will be formatted automatically in the final notes."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Editing Guidelines:"}),e.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[e.jsx("li",{children:"• Ensure compliance with applicable Accounting Standards (AS)"}),e.jsx("li",{children:"• Include specific measurement and recognition criteria"}),e.jsx("li",{children:"• Mention any significant estimates or judgments"}),e.jsx("li",{children:"• Keep language clear and professional"}),e.jsx("li",{children:"• Separate different concepts into distinct paragraphs"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>l(null),className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:d.isPending,className:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors disabled:opacity-50 flex items-center space-x-2",children:[d.isPending&&e.jsx(j,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:d.isPending?"Saving...":"Save Policy"})]})]})]})]})})}),(!s.data||s.data.length===0)&&!s.isLoading&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sample Accounting Policies"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"These are examples of standard accounting policies that would be available for editing:"}),e.jsx("div",{className:"space-y-4",children:S().slice(0,2).map((t,x)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800",children:t.noteRef}),e.jsx("h4",{className:"font-medium text-gray-900",children:t.title})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:t.content})]},x))})]})]})})}export{G as component};
