import{u as G,b as J,r as l,o as K,s as j,z as t,j as e}from"./index-HyfZDTXf.js";import{u as A,L as V,o as E,g as W,p as X,b as C,i as Y}from"./Layout-tNQcTW0Y.js";import{u as c,a as M,b as P}from"./zod-DIWepabP.js";import{F as Z}from"./ComputerDesktopIcon-C0apim9b.js";import{F as _}from"./XCircleIcon--1cEXXGA.js";import{F as ee}from"./PencilIcon-DKVLbX6N.js";import{F as se}from"./TrashIcon-CLoa2qnK.js";function le(){const o=G(),{selectedCompanyId:a}=J(),[d,w]=l.useState([]),[r,m]=l.useState(null),[v,p]=l.useState(!1),S=K({noteRef:j().min(1,"Note reference is required"),description:j().min(1,"Description is required"),linkedMajorHead:j().optional()}),n=A(a?o.getNoteSelections.queryOptions({companyId:a}):{enabled:!1}),R=A(o.getMajorHeads.queryOptions()),h=c({...o.updateNoteSelections.mutationOptions(),onSuccess:()=>{t.success("Note selections saved successfully!"),n.refetch()},onError:s=>{t.error("Failed to save selections: "+s.message)}}),g=c({...o.updateNoteNumbers.mutationOptions(),onSuccess:()=>{t.success("Note numbers updated successfully!"),n.refetch()},onError:s=>{t.error("Failed to update note numbers: "+s.message)}}),f=c({...o.addNoteSelection.mutationOptions(),onSuccess:()=>{t.success("Note added successfully!"),n.refetch(),p(!1),k()},onError:s=>{t.error("Failed to add note: "+s.message)}}),y=c({...o.updateNoteSelection.mutationOptions(),onSuccess:()=>{t.success("Note updated successfully!"),n.refetch(),m(null)},onError:s=>{t.error("Failed to update note: "+s.message)}}),$=c({...o.deleteNoteSelection.mutationOptions(),onSuccess:()=>{t.success("Note deleted successfully!"),n.refetch()},onError:s=>{t.error("Failed to delete note: "+s.message)}}),{register:b,handleSubmit:H,reset:k,formState:{errors:x}}=M({resolver:P(S)}),{register:N,handleSubmit:O,reset:F,formState:{errors:u}}=M({resolver:P(S)});l.useEffect(()=>{n.data&&w(n.data.map(s=>({...s,userSelected:s.finalSelected})))},[n.data]),l.useEffect(()=>{r&&F({noteRef:r.noteRef,description:r.description,linkedMajorHead:r.linkedMajorHead||""})},[r,F]);const D=s=>{w(d.map(i=>i.noteRef===s?{...i,userSelected:!i.userSelected}:i))},I=()=>{if(!a){t.error("Please select a company first");return}const s=d.map(({noteRef:i,userSelected:B})=>({noteRef:i,userSelected:B}));h.mutate({companyId:a,selections:s})},T=()=>{if(!a){t.error("Please select a company first");return}g.mutate({companyId:a})},U=async s=>{if(!a){t.error("Please select a company first");return}await f.mutateAsync({companyId:a,...s})},q=async s=>{r&&await y.mutateAsync({id:r.id,...s})},L=async s=>{confirm("Are you sure you want to delete this note?")&&await $.mutateAsync({id:s})},z=d.filter(s=>s.userSelected).length,Q=d.filter(s=>s.systemRecommended).length;return e.jsx(V,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Notes to Accounts Selection"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Select the notes to be included in the financial statements"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>p(!v),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx("span",{children:"Add Note"})]}),e.jsx("button",{onClick:T,disabled:g.isPending,className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center space-x-2",children:e.jsx("span",{children:g.isPending?"Numbering...":"Auto Number"})}),e.jsxs("button",{onClick:I,disabled:h.isPending,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center space-x-2",children:[e.jsx(X,{className:"h-5 w-5"}),e.jsx("span",{children:h.isPending?"Saving...":"Save Selections"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Notes Available"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-8 w-8 text-purple-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Q}),e.jsx("p",{className:"text-sm text-gray-600",children:"System Recommended"})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:z}),e.jsx("p",{className:"text-sm text-gray-600",children:"User Selected"})]})]})})]}),v&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add New Note"}),e.jsxs("form",{onSubmit:H(U),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note Reference *"}),e.jsx("input",{...b("noteRef"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"e.g., A.2.17"}),x.noteRef&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:x.noteRef.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Linked Major Head"}),e.jsxs("select",{...b("linkedMajorHead"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Select major head (optional)"}),R.data?.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),e.jsx("textarea",{...b("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter note description"}),x.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:x.description.message})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{p(!1),k()},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:f.isPending,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors disabled:opacity-50",children:f.isPending?"Adding...":"Add Note"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Notes for Inclusion"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Note Ref"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Auto Number"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"System Rec."}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Selection"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:s.noteRef}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-800",children:s.description}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.autoNumber?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:s.autoNumber||"--"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.systemRecommended?e.jsx(C,{className:"h-6 w-6 text-green-500 mx-auto"}):e.jsx(_,{className:"h-6 w-6 text-gray-300 mx-auto"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("button",{onClick:()=>D(s.noteRef),className:`p-1 rounded-full transition-colors ${s.userSelected?"bg-indigo-600 hover:bg-indigo-700":"bg-gray-200 hover:bg-gray-300"}`,children:e.jsx("div",{className:`w-6 h-6 rounded-full bg-white shadow-sm transform transition-transform ${s.userSelected?"translate-x-6":"translate-x-0"}`})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{onClick:()=>m(s),className:"text-indigo-600 hover:text-indigo-900 p-1",title:"Edit note",children:e.jsx(ee,{className:"h-4 w-4"})}),!s.systemRecommended&&e.jsx("button",{onClick:()=>L(s.id),className:"text-red-600 hover:text-red-900 p-1",title:"Delete note",children:e.jsx(se,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Note"}),e.jsx("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Y,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:O(q),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note Reference *"}),e.jsx("input",{...N("noteRef"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",disabled:r.systemRecommended}),u.noteRef&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.noteRef.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Linked Major Head"}),e.jsxs("select",{...N("linkedMajorHead"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Select major head (optional)"}),R.data?.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),e.jsx("textarea",{...N("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"}),u.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.description.message})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>m(null),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:y.isPending,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors disabled:opacity-50",children:y.isPending?"Updating...":"Update Note"})]})]})]})})})]})})}export{le as component};
