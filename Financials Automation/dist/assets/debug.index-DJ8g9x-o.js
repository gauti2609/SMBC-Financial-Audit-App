import{r as i,u as f,b as y,j as e}from"./index-HyfZDTXf.js";import{u as w,L as c,n as v,v as h,f as C,r as b,b as m,h as g}from"./Layout-tNQcTW0Y.js";import{F as o}from"./XCircleIcon--1cEXXGA.js";import{F as k}from"./InformationCircleIcon-dadFmOSF.js";import"./zod-DIWepabP.js";function D({title:n,titleId:t,...d},a){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},d),n?i.createElement("title",{id:t},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75"}))}const j=i.forwardRef(D);function R({title:n,titleId:t,...d},a){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},d),n?i.createElement("title",{id:t},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"}))}const x=i.forwardRef(R);function I(){const n=f(),{selectedCompanyId:t,selectedCompany:d}=y(),a=w(t?n.debugCompliance.queryOptions({companyId:t}):{enabled:!1}),u=l=>l==="pass"?e.jsx(m,{className:"h-5 w-5 text-green-600"}):e.jsx(o,{className:"h-5 w-5 text-red-600"}),p=l=>l==="pass"?"bg-green-100 text-green-800 border-green-200":"bg-red-100 text-red-800 border-red-200";if(!t)return e.jsx(c,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Schedule III Compliance Diagnostics"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"System health check and troubleshooting information"})]})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(v,{className:"h-8 w-8 text-blue-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-blue-900",children:"Company Selection Required"})]}),e.jsx("p",{className:"text-blue-800",children:"Please select a company from the header to view its diagnostic information."})]})]})});if(a.isLoading)return e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Running compliance diagnostics..."})]})})});if(a.isError)return e.jsx(c,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Compliance Debug - Critical Error"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Unable to run diagnostic checks"})]})]})}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(o,{className:"h-8 w-8 text-red-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-red-900",children:"Diagnostic Failure"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-red-800",children:"The diagnostic system itself failed to run. This indicates a serious system-level issue:"}),e.jsxs("div",{className:"bg-red-100 border border-red-300 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Error Details:"}),e.jsx("pre",{className:"text-sm text-red-800 whitespace-pre-wrap",children:a.error?.message||"Unknown critical error"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-semibold text-red-900",children:"Possible causes:"}),e.jsxs("ul",{className:"list-disc list-inside text-red-700 space-y-1",children:[e.jsx("li",{children:"Database server is completely down"}),e.jsx("li",{children:"Network connectivity issues"}),e.jsx("li",{children:"Server application crash"}),e.jsx("li",{children:"Critical configuration errors"})]})]}),e.jsxs("button",{onClick:()=>a.refetch(),className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center",children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Retry Diagnostics"]})]})]})]})});const s=a.data;return s?e.jsx(c,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Schedule III Compliance Diagnostics"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["System health check and troubleshooting information",d&&e.jsxs("span",{className:"ml-2 text-indigo-600 font-medium",children:["â€¢ ",d.displayName]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Last run:"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s?.timestamp?new Date(s.timestamp).toLocaleString():"Not run"}),e.jsxs("button",{onClick:()=>a.refetch(),className:"mt-2 bg-indigo-600 text-white px-3 py-1 rounded text-sm hover:bg-indigo-700 transition-colors flex items-center",children:[e.jsx(h,{className:"h-4 w-4 mr-1"}),"Refresh"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(b,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Database Connection"})]}),e.jsxs("div",{className:`flex items-center p-4 rounded-lg border ${s.databaseConnection?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[s.databaseConnection?e.jsx(m,{className:"h-6 w-6 text-green-600 mr-3"}):e.jsx(o,{className:"h-6 w-6 text-red-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s.databaseConnection?"text-green-900":"text-red-900"}`,children:s.databaseConnection?"Connected":"Connection Failed"}),e.jsx("p",{className:`text-sm ${s.databaseConnection?"text-green-700":"text-red-700"}`,children:s.databaseConnection?"Database is accessible and responding":"Unable to connect to the database"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(g,{className:"h-6 w-6 text-purple-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Database Tables Status"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(s.tablesStatus).map(([l,r])=>e.jsxs("div",{className:`p-4 rounded-lg border ${r.exists?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:l}),r.exists?e.jsx(m,{className:"h-5 w-5 text-green-600"}):e.jsx(o,{className:"h-5 w-5 text-red-600"})]}),e.jsx("p",{className:`text-sm ${r.exists?"text-green-700":"text-red-700"}`,children:r.exists?`${r.count} records`:r.error||"Table not accessible"})]},l))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(j,{className:"h-6 w-6 text-green-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"System Health Checks"})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.basicChecks).map(([l,r])=>e.jsxs("div",{className:`p-4 rounded-lg border ${p(r.status)}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[u(r.status),e.jsx("h3",{className:"ml-3 font-medium text-gray-900",children:l.replace(/([A-Z])/g," $1").replace(/^./,N=>N.toUpperCase())})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r.status==="pass"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.status.toUpperCase()})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:r.message})]},l))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(k,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Troubleshooting Guide"})]}),e.jsxs("div",{className:"space-y-6",children:[!s.databaseConnection&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Database Connection Issues"}),e.jsxs("ul",{className:"list-disc list-inside text-red-700 space-y-1",children:[e.jsx("li",{children:"Check if the database server is running"}),e.jsx("li",{children:"Verify database connection credentials"}),e.jsx("li",{children:"Ensure network connectivity to the database"}),e.jsx("li",{children:"Check if the database URL in the configuration is correct"})]})]}),s.basicChecks.majorHeadsSeeded?.status==="fail"&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Missing Master Data"}),e.jsxs("ul",{className:"list-disc list-inside text-yellow-700 space-y-1",children:[e.jsx("li",{children:"Run the database setup script to seed master data"}),e.jsx("li",{children:"Check if the application initialization completed successfully"}),e.jsx("li",{children:"Manually initialize major heads and groupings if needed"})]})]}),s.basicChecks.trialBalanceData?.status==="fail"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"No Financial Data"}),e.jsxs("ul",{className:"list-disc list-inside text-blue-700 space-y-1",children:[e.jsx("li",{children:"Upload trial balance data to get started"}),e.jsx("li",{children:"Configure entity information in Common Control settings"}),e.jsx("li",{children:"The compliance module requires basic financial data to function"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("a",{href:"/trial-balance",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors inline-block",children:"Upload Trial Balance"})})]}),s.basicChecks.mainComplianceProcedure?.status==="pass"&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"System is Working"}),e.jsx("p",{className:"text-green-700",children:"All core systems are functioning properly. The compliance module should be working correctly."}),e.jsx("div",{className:"mt-3",children:e.jsx("a",{href:"/compliance-dashboard",className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors inline-block",children:"View Compliance Dashboard"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("a",{href:"/compliance-dashboard",className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(j,{className:"h-6 w-6 text-indigo-600 mr-3"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Compliance Dashboard"})]}),e.jsxs("a",{href:"/common-control",className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(b,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Entity Settings"})]}),e.jsxs("a",{href:"/trial-balance",className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(g,{className:"h-6 w-6 text-green-600 mr-3"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Trial Balance"})]})]})]})]})}):e.jsx(c,{children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(C,{className:"h-8 w-8 text-yellow-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-yellow-900",children:"No Debug Data"})]}),e.jsx("p",{className:"text-yellow-800",children:"Debug procedure completed but returned no data."})]})})}export{I as component};
