import{u as p,z as g,j as e}from"./index-HyfZDTXf.js";import{u as o,L as m,m as j,f as y,l as b}from"./Layout-tNQcTW0Y.js";import{u as f}from"./zod-DIWepabP.js";import{F as v,a as C}from"./ShareIcon-B0PFCHYT.js";function Y(){const i=p(),h=o(i.generateProfitAndLoss.queryOptions()),N=o(i.getCommonControl.queryOptions()),c=o(i.calculateTaxExpense.queryOptions()),x=f({...i.exportProfitAndLoss.mutationOptions(),onSuccess:t=>{g.success("Profit & Loss exported successfully!"),window.open(t.downloadUrl,"_blank")},onError:t=>{g.error("Failed to export profit & loss: "+t.message)}}),d=o(i.validateFinancialStatementFormat.queryOptions({statementType:"profit_loss"})),u=()=>{x.mutate({format:"xlsx"})},n=t=>new Intl.NumberFormat("en-IN",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.abs(t)),l=(t,s="Brackets")=>{if(t>=0)return n(t);switch(s){case"Red":return e.jsx("span",{className:"text-red-600",children:n(t)});case"Minus":return`-${n(t)}`;default:return`(${n(t)})`}},r=N.data,a=h.data;return h.isLoading?e.jsx(m,{children:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Generating Profit & Loss Statement..."})]})})}):!a||!a.revenue.length&&!a.expenses.length?e.jsx(m,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Profit & Loss Statement"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Generate your Schedule III compliant profit & loss statement"})]})]})}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex",children:[e.jsx(y,{className:"h-6 w-6 text-amber-600 mt-1"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-medium text-amber-800",children:"No Data Available"}),e.jsx("p",{className:"text-amber-700 mt-1",children:"Please upload trial balance data with P&L entries first to generate the profit & loss statement."}),e.jsx("div",{className:"mt-4",children:e.jsx("a",{href:"/trial-balance",className:"bg-amber-600 hover:bg-amber-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:"Upload Trial Balance"})})]})]})})]})}):e.jsx(m,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Profit & Loss Statement"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["For the year ended ",r?.financialYearEnd?new Date(r.financialYearEnd).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"}):"March 31, 2024"]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(v,{className:"h-5 w-5"}),e.jsx("span",{children:"Print"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(C,{className:"h-5 w-5"}),e.jsx("span",{children:"Share"})]}),e.jsxs("button",{onClick:u,disabled:x.isPending,className:"flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:[e.jsx(b,{className:"h-5 w-5"}),e.jsx("span",{children:x.isPending?"Exporting...":"Export to Excel"})]})]})]})}),d.data&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedule III Compliance"}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${d.data.formatCompliant?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:d.data.formatCompliant?"Compliant":"Recommendations"})]}),d.data.issues.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Recommendations:"}),e.jsx("ul",{className:"space-y-1",children:d.data.issues.map((t,s)=>e.jsxs("li",{className:"text-sm text-yellow-600 flex items-start",children:[e.jsx(y,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0"}),t]},s))})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-8",style:{fontFamily:r?.defaultFont||"Bookman Old Style, serif"},children:[e.jsxs("div",{className:"text-center mb-8 border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:r?.entityName||"Entity Name"}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:r?.address||"Entity Address"}),r?.cinNumber&&e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["CIN: ",r.cinNumber]}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-1",children:["Statement of Profit and Loss for the year ended ",r?.financialYearEnd?new Date(r.financialYearEnd).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"}):"March 31, 2024"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["(All amounts in ",r?.currency||"INR"," ",r?.units||"Millions",")"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"text-left py-3 font-semibold text-gray-900",style:{width:"50%"},children:"Particulars"}),e.jsx("th",{className:"text-center py-3 font-semibold text-gray-900",style:{width:"10%"},children:"Note No."}),e.jsx("th",{className:"text-right py-3 font-semibold text-gray-900",style:{width:"20%"},children:"Figures for current reporting period"}),e.jsx("th",{className:"text-right py-3 font-semibold text-gray-900",style:{width:"20%"},children:"Figures for previous reporting period"})]})}),e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4",children:e.jsx("h4",{className:"font-bold text-gray-900 text-lg",children:"I. REVENUE"})})}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Revenue from operations"}),e.jsx("td",{className:"text-center text-gray-600",children:"1"}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.revenue.filter(t=>t.majorHead?.name?.includes("Revenue from Operations")).reduce((t,s)=>t+Math.abs(Number(s.closingBalanceCY)),0),r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.revenue.filter(t=>t.majorHead?.name?.includes("Revenue from Operations")).reduce((t,s)=>t+Math.abs(Number(s.closingBalancePY)),0),r?.negativeColor)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Other income"}),e.jsx("td",{className:"text-center text-gray-600",children:"2"}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.revenue.filter(t=>t.majorHead?.name?.includes("Other Income")).reduce((t,s)=>t+Math.abs(Number(s.closingBalanceCY)),0),r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.revenue.filter(t=>t.majorHead?.name?.includes("Other Income")).reduce((t,s)=>t+Math.abs(Number(s.closingBalancePY)),0),r?.negativeColor)})]}),e.jsxs("tr",{className:"border-t border-gray-200",children:[e.jsx("td",{className:"py-2 font-semibold text-gray-900",children:"Total Revenue (I)"}),e.jsx("td",{}),e.jsx("td",{className:"text-right font-semibold text-gray-900",children:l(a.totalRevenue,r?.negativeColor)}),e.jsx("td",{className:"text-right font-semibold text-gray-900",children:l(a.revenue.reduce((t,s)=>t+Math.abs(Number(s.closingBalancePY)),0),r?.negativeColor)})]}),e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-6",children:e.jsx("h4",{className:"font-bold text-gray-900 text-lg",children:"II. EXPENSES"})})}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Cost of materials consumed"}),e.jsx("td",{className:"text-center text-gray-600",children:"3"}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Cost of Materials")).reduce((t,s)=>t+Number(s.closingBalanceCY),0),r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Cost of Materials")).reduce((t,s)=>t+Number(s.closingBalancePY),0),r?.negativeColor)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Employee benefits expense"}),e.jsx("td",{className:"text-center text-gray-600",children:"4"}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Employee Benefits")).reduce((t,s)=>t+Number(s.closingBalanceCY),0),r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Employee Benefits")).reduce((t,s)=>t+Number(s.closingBalancePY),0),r?.negativeColor)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Finance costs"}),e.jsx("td",{className:"text-center text-gray-600",children:"5"}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Finance Costs")).reduce((t,s)=>t+Number(s.closingBalanceCY),0),r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Finance Costs")).reduce((t,s)=>t+Number(s.closingBalancePY),0),r?.negativeColor)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Depreciation and amortization expense"}),e.jsx("td",{className:"text-center text-gray-600",children:"6"}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Depreciation")).reduce((t,s)=>t+Number(s.closingBalanceCY),0),r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Depreciation")).reduce((t,s)=>t+Number(s.closingBalancePY),0),r?.negativeColor)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Other expenses"}),e.jsx("td",{className:"text-center text-gray-600",children:"7"}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Other Expenses")).reduce((t,s)=>t+Number(s.closingBalanceCY),0),r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(a.expenses.filter(t=>t.majorHead?.name?.includes("Other Expenses")).reduce((t,s)=>t+Number(s.closingBalancePY),0),r?.negativeColor)})]}),e.jsxs("tr",{className:"border-t border-gray-200",children:[e.jsx("td",{className:"py-2 font-semibold text-gray-900",children:"Total Expenses (II)"}),e.jsx("td",{}),e.jsx("td",{className:"text-right font-semibold text-gray-900",children:l(a.totalExpenses,r?.negativeColor)}),e.jsx("td",{className:"text-right font-semibold text-gray-900",children:l(a.expenses.reduce((t,s)=>t+Number(s.closingBalancePY),0),r?.negativeColor)})]}),e.jsxs("tr",{className:"border-t-2 border-gray-300",children:[e.jsx("td",{className:"py-3 font-bold text-gray-900",children:"Profit/(Loss) before tax (I-II)"}),e.jsx("td",{}),e.jsx("td",{className:"text-right font-bold text-gray-900",children:l(a.netProfit,r?.negativeColor)}),e.jsx("td",{className:"text-right font-bold text-gray-900",children:l(a.revenue.reduce((t,s)=>t+Math.abs(Number(s.closingBalancePY)),0)-a.expenses.reduce((t,s)=>t+Number(s.closingBalancePY),0),r?.negativeColor)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pl-4 text-gray-800",children:"Tax expense"}),e.jsx("td",{className:"text-center text-gray-600",children:"8"}),e.jsx("td",{className:"text-right text-gray-900",children:l(c.data?.totalCurrentYear||0,r?.negativeColor)}),e.jsx("td",{className:"text-right text-gray-900",children:l(c.data?.totalPreviousYear||0,r?.negativeColor)})]}),e.jsxs("tr",{className:"border-t-2 border-gray-300",children:[e.jsx("td",{className:"py-3 font-bold text-gray-900",children:"Profit/(Loss) for the period"}),e.jsx("td",{}),e.jsx("td",{className:"text-right font-bold text-gray-900",children:l(a.netProfit-(c.data?.totalCurrentYear||0),r?.negativeColor)}),e.jsx("td",{className:"text-right font-bold text-gray-900",children:l(a.revenue.reduce((t,s)=>t+Math.abs(Number(s.closingBalancePY)),0)-a.expenses.reduce((t,s)=>t+Number(s.closingBalancePY),0)-(c.data?.totalPreviousYear||0),r?.negativeColor)})]}),e.jsxs("tr",{className:"border-t border-gray-200",children:[e.jsxs("td",{className:"py-2 font-semibold text-gray-900",children:["Earnings per equity share (in ",r?.currency||"INR",")"]}),e.jsx("td",{className:"text-center text-gray-600",children:"9"}),e.jsx("td",{}),e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 pl-4 text-gray-800",children:"(1) Basic"}),e.jsx("td",{}),e.jsx("td",{className:"text-right text-gray-900",children:"--"}),e.jsx("td",{className:"text-right text-gray-900",children:"--"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-1 pl-4 text-gray-800",children:"(2) Diluted"}),e.jsx("td",{}),e.jsx("td",{className:"text-right text-gray-900",children:"--"}),e.jsx("td",{className:"text-right text-gray-900",children:"--"})]})]})]})}),e.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-16 border-b border-gray-300 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Director"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-16 border-b border-gray-300 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Company Secretary"})]})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600 mb-2",children:["₹",n(a.totalRevenue)]}),e.jsx("p",{className:"text-gray-600",children:"Total Revenue"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-red-600 mb-2",children:["₹",n(a.totalExpenses)]}),e.jsx("p",{className:"text-gray-600",children:"Total Expenses"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 ${a.netProfit>=0?"text-blue-600":"text-red-600"}`,children:["₹",n(a.netProfit)]}),e.jsx("p",{className:"text-gray-600",children:a.netProfit>=0?"Net Profit":"Net Loss"})]})})]})]})})}export{Y as component};
