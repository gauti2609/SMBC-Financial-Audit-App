import{u as N,b as f,z as c,j as e}from"./index-HyfZDTXf.js";import{u as x,L as o,c as p,f as w,l as v,b as g}from"./Layout-tNQcTW0Y.js";import{u as A}from"./zod-DIWepabP.js";import{F,a as R}from"./ShareIcon-B0PFCHYT.js";import{F as b}from"./XCircleIcon--1cEXXGA.js";import{F as S}from"./InformationCircleIcon-dadFmOSF.js";function D(){const d=N(),{selectedCompanyId:l}=f(),m=x(l?d.getAgingSchedules.queryOptions({companyId:l}):{enabled:!1}),j=x(l?d.checkTrialBalanceReconciliation.queryOptions({companyId:l}):{enabled:!1}),y=x(l?d.getCommonControl.queryOptions({companyId:l}):{enabled:!1}),n=A({...d.exportAgingSchedules.mutationOptions(),onSuccess:r=>{c.success("Aging schedules exported successfully!"),window.open(r.downloadUrl,"_blank")},onError:r=>{c.error("Failed to export aging schedules: "+r.message)}}),u=()=>{if(!l){c.error("Please select a company first");return}n.mutate({companyId:l,format:"xlsx"})},s=r=>new Intl.NumberFormat("en-IN",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(r),a=m.data,t=j.data,h=y.data;return m.isLoading?e.jsx(o,{children:e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading aging schedules..."})]})})}):a?e.jsx(o,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Aging Schedules"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Receivables and Payables aging analysis as at ",h?.financialYearEnd?new Date(h.financialYearEnd).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"}):"March 31, 2024"]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{children:"Print"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(R,{className:"h-5 w-5"}),e.jsx("span",{children:"Share"})]}),e.jsxs("button",{onClick:u,disabled:n.isPending,className:"flex items-center space-x-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:[e.jsx(v,{className:"h-5 w-5"}),e.jsx("span",{children:n.isPending?"Exporting...":"Export to Excel"})]})]})]})}),t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Receivables Reconciliation"}),t.receivables.reconciled?e.jsx(g,{className:"h-6 w-6 text-green-600"}):e.jsx(b,{className:"h-6 w-6 text-red-600"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Trial Balance:"}),e.jsxs("span",{children:["₹",s(t.receivables.trialBalanceAmount)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Ledger Total:"}),e.jsxs("span",{children:["₹",s(t.receivables.ledgerTotal)]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-medium",children:"Variance:"}),e.jsxs("span",{className:`font-medium ${t.receivables.reconciled?"text-green-600":"text-red-600"}`,children:["₹",s(Math.abs(t.receivables.variance))]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payables Reconciliation"}),t.payables.reconciled?e.jsx(g,{className:"h-6 w-6 text-green-600"}):e.jsx(b,{className:"h-6 w-6 text-red-600"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Trial Balance:"}),e.jsxs("span",{children:["₹",s(t.payables.trialBalanceAmount)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Ledger Total:"}),e.jsxs("span",{children:["₹",s(t.payables.ledgerTotal)]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-medium",children:"Variance:"}),e.jsxs("span",{className:`font-medium ${t.payables.reconciled?"text-green-600":"text-red-600"}`,children:["₹",s(Math.abs(t.payables.variance))]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:["₹",s(a.receivables.totalOutstanding)]}),e.jsx("p",{className:"text-gray-600",children:"Total Receivables"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.receivables.entries.length," entries"]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600 mb-2",children:["₹",s(a.receivables.advanceFromCustomers)]}),e.jsx("p",{className:"text-gray-600",children:"Advance from Customers"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Credit balances"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-red-600 mb-2",children:["₹",s(a.payables.totalOutstanding)]}),e.jsx("p",{className:"text-gray-600",children:"Total Payables"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.payables.entries.length," entries"]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:["₹",s(a.payables.advanceToSuppliers)]}),e.jsx("p",{className:"text-gray-600",children:"Advance to Suppliers"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Debit balances"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Trade Receivables Aging"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Aging analysis with disputed/undisputed classification"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age Bucket"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Undisputed"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Disputed"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"% of Total"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(a.receivables.aging).map(([r,i])=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:r}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:["₹",s(i.undisputed)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 text-right",children:["₹",s(i.disputed)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-right",children:["₹",s(i.total)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:[(i.total/a.receivables.totalOutstanding*100).toFixed(1),"%"]})]},r))})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Trade Payables Aging"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Aging analysis with MSME/Others classification"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age Bucket"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"MSME"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Others"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Disputed"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"% of Total"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(a.payables.aging).map(([r,i])=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:r}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-orange-600 text-right",children:["₹",s(i.msme)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:["₹",s(i.others)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 text-right",children:["₹",s(i.disputed)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-right",children:["₹",s(i.total)]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right",children:[(i.total/a.payables.totalOutstanding*100).toFixed(1),"%"]})]},r))})]})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex",children:[e.jsx(S,{className:"h-6 w-6 text-blue-600 mt-1"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-800",children:"Schedule III Compliance"}),e.jsxs("div",{className:"text-blue-700 mt-1 space-y-1 text-sm",children:[e.jsx("p",{children:"• Aging schedules are prepared as per Schedule III requirements"}),e.jsx("p",{children:"• Receivables are classified as Disputed/Undisputed"}),e.jsx("p",{children:"• Payables are classified as MSME/Others with disputed amounts"}),e.jsx("p",{children:'• Negative balances in receivables are treated as "Advance from Customers"'}),e.jsx("p",{children:'• Positive balances in payables are treated as "Advance to Suppliers"'})]})]})]})})]})}):e.jsx(o,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"h-8 w-8 text-indigo-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:"Bookman Old Style, serif"},children:"Aging Schedules"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Receivables and Payables aging analysis"})]})]})}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex",children:[e.jsx(w,{className:"h-6 w-6 text-amber-600 mt-1"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-medium text-amber-800",children:"No Data Available"}),e.jsx("p",{className:"text-amber-700 mt-1",children:"Please upload receivables and payables data to generate aging schedules."})]})]})})]})})}export{D as component};
